<!-- âœ… LOGIN (substitua o seu bloco por este) -->
<div id="loginCard" style="max-width:520px;margin:60px auto;padding:28px;border-radius:18px;background:#0b0b0be6;border:1px solid #2b2b2b;box-shadow:0 10px 30px rgba(0,0,0,.35);">
  <h1 style="margin:0;color:#fff;font-size:44px;font-weight:800;letter-spacing:.5px;">Sistema JF Elite</h1>
  <p style="margin:8px 0 18px;color:#cfcfcf;">Acesso Ã  calculadora</p>

  <!-- IMPORTANTE: form evita bug do Enter, e a gente bloqueia o reload no JS -->
  <form id="loginForm" autocomplete="off">
    <input
      id="accessInput"
      type="text"
      inputmode="email"
      placeholder="Digite seu e-mail ou cÃ³digo"
      style="width:100%;height:58px;border-radius:12px;border:2px solid #3a3a3a;padding:0 14px;font-size:18px;outline:none;"
    />

    <button
      id="enterBtn"
      type="submit"
      style="width:100%;height:62px;margin-top:14px;border-radius:12px;border:none;background:#19c150;color:#0b0b0b;font-size:20px;font-weight:800;cursor:pointer;"
    >
      Entrar
    </button>

    <div id="loginMsg" style="margin-top:14px;min-height:22px;color:#fff;font-size:15px;"></div>
  </form>
</div>

<script>
  // âœ… CONFIG (ajuste se seu endpoint de validaÃ§Ã£o for outro)
  const API_BASE = "https://rough-base-6eb1.jlucasandradeee.workers.dev";

  const form = document.getElementById("loginForm");
  const input = document.getElementById("accessInput");
  const btn = document.getElementById("enterBtn");
  const msg = document.getElementById("loginMsg");

  function setMsg(text, ok=false) {
    msg.textContent = text;
    msg.style.color = ok ? "#31ff7a" : "#ff5a5a";
  }

  async function tryLogin() {
    const raw = (input.value || "").trim();
    if (!raw) {
      setMsg("Digite seu e-mail ou cÃ³digo.");
      return;
    }

    btn.disabled = true;
    btn.style.opacity = "0.85";
    setMsg("Validando acesso...");

    try {
      // ðŸ”¥ Se no seu Worker a rota for /access, fica assim:
      const url = `${API_BASE}/access?key=${encodeURIComponent(raw)}`;

      const r = await fetch(url, { method: "GET" });
      const data = await r.json().catch(() => ({}));

      if (!r.ok || !data || data.ok !== true) {
        const reason = data?.reason || data?.error || "Acesso negado.";
        setMsg(reason);
        btn.disabled = false;
        btn.style.opacity = "1";
        return;
      }

      // âœ… salvando sessÃ£o simples
      localStorage.setItem("jf_access", "1");
      localStorage.setItem("jf_access_key", raw);

      setMsg("Acesso liberado! Entrando...", true);

      // âœ… redireciona para a calculadora
      window.location.href = "./app.html";

    } catch (e) {
      setMsg("Erro ao conectar com o servidor. Verifique o Worker/URL.");
      btn.disabled = false;
      btn.style.opacity = "1";
    }
  }

  // âœ… Clique no botÃ£o e Enter funcionam
  form.addEventListener("submit", (ev) => {
    ev.preventDefault(); // <<< ISSO evita o reload que faz o â€œsumirâ€
    tryLogin();
  });

  // âœ… garante que clique funciona mesmo se algo atrapalhar
  btn.addEventListener("click", (ev) => {
    ev.preventDefault();
    tryLogin();
  });
</script>
