<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MacroPeso Inteligente</title>

  <!-- ÍCONES -->
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png" />
  <link rel="apple-touch-icon" sizes="192x192" href="icone-192.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="icone-192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="icone-512.png" />

  <meta name="theme-color" content="#0b2a1f" />

  <style>
    :root{
      --bg:#070b0a;
      --card:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
      --text:#e9f3ef;
      --muted:rgba(233,243,239,.65);
      --green:#19e27a;
      --green2:#12b861;
      --shadow: 0 12px 60px rgba(25,226,122,.18);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      background:radial-gradient(900px 500px at 50% 40%, rgba(25,226,122,.20), transparent 60%),
                 radial-gradient(700px 400px at 30% 20%, rgba(25,226,122,.10), transparent 65%),
                 var(--bg);
      color:var(--text);
      font-family: Arial, Helvetica, sans-serif;
    }
    .card{
      width:min(720px, 100%);
      padding:28px;
      border-radius:18px;
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid var(--border);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }
    h1{margin:0 0 6px;font-size:42px;letter-spacing:-1px}
    .sub{margin:0 0 18px;color:var(--muted);font-size:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    input{
      flex:1;
      min-width:240px;
      padding:16px 16px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.25);
      color:var(--text);
      outline:none;
      font-size:16px;
    }
    input::placeholder{color:rgba(233,243,239,.45)}
    .btn{
      width:100%;
      margin-top:14px;
      padding:16px 18px;
      border-radius:14px;
      border:0;
      background: linear-gradient(90deg, var(--green), var(--green2));
      color:#052414;
      font-weight:900;
      font-size:18px;
      cursor:pointer;
      box-shadow: 0 10px 35px rgba(25,226,122,.25);
    }
    .btn:active{transform:translateY(1px)}
    .minirow{
      margin-top:12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .ghost{
      flex:1;
      min-width:160px;
      padding:12px 14px;
      border-radius:12px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--border);
      color:var(--text);
      cursor:pointer;
      font-weight:700;
    }
    .msg{
      margin-top:12px;
      font-size:14px;
      color:var(--muted);
      min-height:20px;
    }
    .ok{color:#7CFFB0}
    .bad{color:#ff7b7b}
    .hint{margin-top:10px;font-size:12px;color:rgba(233,243,239,.55)}
    code{color:#7CFFB0}
  </style>
</head>

<body>
  <div class="card">
    <h1>MacroPeso Inteligente</h1>
    <p class="sub">Calculadora nutricional baseada na TACO</p>

    <div class="row">
      <input id="email" type="email" placeholder="Digite seu e-mail" autocomplete="email" />
    </div>

    <button class="btn" id="btnEnter">Entrar</button>

    <div class="minirow">
      <button class="ghost" id="btnClear">Limpar acesso</button>
      <button class="ghost" id="btnGo">Ir direto (se já liberou)</button>
    </div>

    <div class="msg" id="msg"></div>
    <div class="hint">Se estiver no GitHub Pages, o acesso fica salvo neste dispositivo (localStorage).</div>
  </div>

  <script>
    // =========================
    // CONFIGURAÇÃO (opcional)
    // Se você quiser travar por e-mails específicos, preencha aqui:
    // Ex: const ALLOWED_EMAILS = ["cliente1@gmail.com", "cliente2@gmail.com"];
    // Se deixar vazio, libera qualquer e-mail (para o site funcionar agora).
    // =========================
    const ALLOWED_EMAILS = []; // <-- se quiser, bota os e-mails pagos aqui

    const STORAGE_KEY = "mp_access_email";
    const STORAGE_TIME = "mp_access_time";

    const emailEl = document.getElementById("email");
    const msgEl = document.getElementById("msg");

    function setMsg(text, type){
      msgEl.textContent = text;
      msgEl.className = "msg " + (type || "");
    }

    function normalizeEmail(v){
      return String(v || "").trim().toLowerCase();
    }

    function isAllowed(email){
      if (!email.includes("@") || !email.includes(".")) return false;
      if (ALLOWED_EMAILS.length === 0) return true; // libera geral p/ funcionar
      return ALLOWED_EMAILS.includes(email);
    }

    function saveAccess(email){
      localStorage.setItem(STORAGE_KEY, email);
      localStorage.setItem(STORAGE_TIME, String(Date.now()));
    }

    function hasAccess(){
      const e = normalizeEmail(localStorage.getItem(STORAGE_KEY));
      return !!e;
    }

    function goApp(){
      // app.html no mesmo diretório
      window.location.href = "app.html";
    }

    document.getElementById("btnEnter").addEventListener("click", () => {
      const email = normalizeEmail(emailEl.value);

      if (!isAllowed(email)){
        setMsg("E-mail inválido ou não autorizado.", "bad");
        return;
      }

      saveAccess(email);
      setMsg("Acesso liberado. Entrando...", "ok");

      setTimeout(goApp, 350);
    });

    document.getElementById("btnClear").addEventListener("click", () => {
      localStorage.removeItem(STORAGE_KEY);
      localStorage.removeItem(STORAGE_TIME);
      setMsg("Acesso apagado neste dispositivo.", "ok");
      emailEl.value = "";
      emailEl.focus();
    });

    document.getElementById("btnGo").addEventListener("click", () => {
      if (!hasAccess()){
        setMsg("Ainda não tem acesso salvo. Digite o e-mail e clique em Entrar.", "bad");
        return;
      }
      goApp();
    });

    // Enter do teclado
    emailEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") document.getElementById("btnEnter").click();
    });

    // Se já tiver acesso salvo, mostra mensagem
    const saved = normalizeEmail(localStorage.getItem(STORAGE_KEY));
    if (saved){
      setMsg("Acesso já salvo neste dispositivo. Pode clicar em “Ir direto”.", "ok");
      emailEl.value = saved;
    }
  </script>
</body>
</html>
